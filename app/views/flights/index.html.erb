<h2><%= link_to "Flight Booker!", root_url %></h2>

<%= form_with url: '/flights', method: 'get', data: { turbo: false } do %>
  <%= select_tag(:departing_id, options_for_select(@departures, params[:departing_id])) %>
  <%= select_tag(:destination_id, options_for_select(@destinations, params[:destination_id])) %>
  <%= select_tag(:num_passengers, options_for_select((1..4), params[:num_passengers])) %>
  <%= select_tag(:start_time, options_for_select(@flight_dates, params[:start_time])) %>
  <%= submit_tag('Search') %>
<% end %>

<% unless @flight_results.nil? %>
    <% if @flight_results.empty? %>
      <p>No Results Found.</p>
    <% else %>
      <%= form_with url: '/bookings', method: 'get', data: { turbo: false }, class: 'search-results' do %>
        <%= hidden_field_tag 'num_passengers', value = params[:num_passengers] %>
        <% @flight_results.each do |flight| %>
          <div class="flight-results">
          <%= label_tag "flight_id_#{flight.id}" do %>
              <div class="flight-details">
                <p><%= flight.departure.airport_code %></p>
                <%= image_tag('right-arrow-purple.png', class: 'image') %>
                <p><%= flight.destination.airport_code %></p>
                <p><%= flight.start_time %></p>
                <p><%= flight.duration %> hours</p>
                <p><%= flight.start_time + flight.duration.hours %></p>
              </div>
            <% end %>
            <div class="flight-select">
              <%= radio_button_tag :flight_id, flight.id %>
            </div>
          </div>
        <% end %>
        <%= submit_tag('Start flying!', class: 'button action') %>
      <% end %>
    <% end %>
<% end %>

